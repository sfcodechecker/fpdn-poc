window.ReadSpeaker||(window.ReadSpeaker={}),window.ReadSpeaker.DocReader||(window.ReadSpeaker.DocReader={}),window.ReadSpeaker.DocReader.AutoAdd=function(){var a=function(a,b){var c=document.createElement("img");c.setAttribute("src",d.img_href),c.setAttribute("alt",d.img_alt),c.setAttribute("title",d.img_alt),c.style.border="0px",c.style.display="inline",c.style.margin="0px",c.style.position="absolute",c.className="rspkr_dr_img";var e=a.getAttribute("hreflang");e&&""!==e&&d.useHrefLang!==!1||(e=d.lang);var f=document.createElement("a"),g=document.location.protocol+"//docreader.readspeaker.com/docreader/?cid=REPLACE_CID&lang=REPLACE_LANG&url=REPLACE_URL";g=g.replace("REPLACE_CID",d.cid),g=g.replace("REPLACE_LANG",e),g=g.replace("REPLACE_URL",encodeURIComponent(b)),f.setAttribute("href",g),f.setAttribute("onclick","window.open(this.href); return false;"),f.style.margin="0 0 0 3px",f.className="rspkr_dr_link",f.onclick=function(){return window.open(this.href),!1},f.setAttribute("target","_blank"),f.appendChild(c),a.className+=a.className.length>0?" "+d.drAddedClass:d.drAddedClass;var h=document.createDocumentFragment();h.appendChild(f);var i=a.nextSibling;d.drBeforeLink&&(i=a),a.parentNode.insertBefore(h,i)},b=function(a){var b=a.href,c=a.className;if(b&&b.length>1){if(c.match(new RegExp(d.drAddedClass,"i")))return!1;if(c.match(new RegExp("rspkr_dr_link","i")))return!1;if(b.match(new RegExp("("+d.doc_list.join("|")+")([^a-zA-Z0-9]|$)","i")))return!0;if(c.match(new RegExp(d.drClass,"i")))return!0}return!1},c=function(a){var b="";return b=a.indexOf("http")>-1||a.indexOf("https")>-1?a:0===a.indexOf("/")?document.location.protocol+"://"+document.location.hostname+a:-1===a.indexOf("/")?document.location.protocol+"://"+document.location.hostname+document.location.pathname+a:a},d={cid:"cktoa",doc_list:["\\.doc","\\.docx","\\.odt","\\.pdf","\\.rtf","\\.ppt","\\.pptx","\\.xls","\\.xlsx","\\.epub","type=drlink"],img_href:document.location.protocol+"//media.readspeaker.com/images/buttons/listen_icons/icon_16px.gif",img_alt:"Open this document with ReadSpeaker docReader",lang:"en_us",useHrefLang:!0,drClass:"rspkr_add_drlink",drAddedClass:"rspkr_dr_added",drBeforeLink:!1},e=function(a,b){b=b||d;for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c])};return{init:function(){"object"==typeof window.rsDocReaderConf&&e(window.rsDocReaderConf);for(var d,f=document.getElementsByTagName("A"),g=[],h=0;h<f.length;h++)g[h]=f[h];for(var i=0;i<g.length;i++)b(g[i])&&(d=c(g[i].href),""!==d&&a(g[i],d))},Settings:d}}(),function(i){window.ReadSpeaker&&window.ReadSpeaker.q&&window.ReadSpeaker.q(window.ReadSpeaker.DocReader.AutoAdd.init);var u=navigator.userAgent,e=eval/*@cc_on! @*/false,st=setTimeout;/webkit/i.test(u)?st(function(){var a=document.readyState;"loaded"===a||"complete"===a?i():st(arguments.callee,10)},10):/mozilla/i.test(u)&&!/(compati)/.test(u)||/opera/i.test(u)?document.readyState&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",i,!1):i()):e?!function(){var a=document.createElement("doc:rdy");try{a.doScroll("left"),i(),a=null}catch(b){st(arguments.callee,0)}}():window.onload=i}(window.ReadSpeaker.DocReader.AutoAdd.init);
